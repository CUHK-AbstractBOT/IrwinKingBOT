<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Irwin King Bot</title>
    <link rel="icon" type="image/png" href="icon.png">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            overflow: hidden; /* 移除滚动条 */
            background-color: #f0f0f0;
            font-family: Arial, sans-serif;
            height: 100vh;
            width: 100vw;
            display: flex;
            flex-direction: column;
        }
        
        #bg1 {
            width: 100%;
            max-width: 800px;
            height: auto;
            margin: 0 auto;
            display: block;
            padding: 10px;
        }
        
        .dialog-box {
            text-align: center;
            padding: 10px 20px;
            margin: 10px 0;
        }
        
        h1 {
            font-size: clamp(1.5rem, 4vw, 2.5rem);
            margin-bottom: 15px;
        }
        
        .input-group {
            display: flex;
            justify-content: center;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        #userInput {
            padding: 10px 15px;
            font-size: clamp(1rem, 2vw, 1.2rem);
            width: min(60vw, 400px);
            border: 2px solid #333;
            border-radius: 5px;
            outline: none;
        }
        
        #userInput:focus {
            border-color: #007bff;
            box-shadow: 0 0 5px rgba(0, 123, 255, 0.5);
        }
        
        button {
            padding: 10px 20px;
            font-size: clamp(1rem, 2vw, 1.2rem);
            cursor: pointer;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
        }
        
        button:hover {
            background-color: #0056b3;
        }
        
        .floating-container {
            position: relative;
            flex-grow: 1;
            margin: 10px;
            overflow: hidden; /* 确保内容不会溢出 */
        }
        
        #bg2 {
            position: absolute;
            width: clamp(80px, 15vw, 150px);
            height: auto;
            transition: all 0.1s linear;
            z-index: 2;
        }
        
        #response {
            position: absolute;
            background-color: white;
            padding: 8px 12px;
            border: 1px solid #ccc;
            border-radius: 5px;
            font-size: clamp(0.8rem, 1.5vw, 1rem);
            color: #333;
            z-index: 3;
            max-width: min(40vw, 250px);
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        @media (max-width: 768px) {
            .input-group {
                flex-direction: column;
                gap: 15px;
            }
            
            #userInput {
                width: 80vw;
            }
        }
    </style>
</head>
<body>
    <div>
        <img id="bg1" src="https://images.unsplash.com/photo-1518709268805-4e9042af2176?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1000&q=80" alt="Top Background Image">
    </div>
    <div class="dialog-box">
        <h1>Irwin King Bot</h1>
        <div class="input-group">
            <input type="text" id="userInput" placeholder="Ask Professor King anything!">
            <button onclick="thinkResponse()">Submit</button>
        </div>
    </div>
    <div class="floating-container">
        <a href="https://www.cse.cuhk.edu.hk/irwin.king/home" target="_blank">
            <img id="bg2" src="https://images.unsplash.com/photo-1568602471122-7832951cc4c5?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=200&q=80" alt="Floating Image">
        </a>
        <div id="response"></div>
    </div>
    <script>
        function thinkResponse() {
            const inputText = document.getElementById('userInput').value;
            const responseDiv = document.getElementById('response');
            const waitSeconds = Math.random() * 4 + 1; // Random wait time between 1 and 5 seconds

            // Display thinking message
            responseDiv.innerHTML = 'Thinking......';

            // Simulate delay
            setTimeout(() => {
                const response = inputText.toLowerCase().includes('it depends')
                    ? `Thought for ${waitSeconds.toFixed(2)} seconds<br>Depends on what?`
                    : `Thought for ${waitSeconds.toFixed(2)} seconds<br>It depends.`;
                responseDiv.innerHTML = response;
            }, waitSeconds * 1000);
        }

        // Continuous floating effect for bg2 image and response
        const bg2 = document.getElementById('bg2');
        const responseDiv = document.getElementById('response');
        const container = document.querySelector('.floating-container');
        
        // 初始速度和位置
        let velocityX = (Math.random() - 0.5) * 2; // 减小速度范围
        let velocityY = (Math.random() - 0.5) * 2;
        
        // 等待图像加载完成
        function initAnimation() {
            const containerRect = container.getBoundingClientRect();
            const imgWidth = bg2.offsetWidth;
            const imgHeight = bg2.offsetHeight;
            
            // 初始位置 - 确保在容器内
            let posX = Math.random() * (containerRect.width - imgWidth);
            let posY = Math.random() * (containerRect.height - imgHeight);
            
            function moveImage() {
                // 更新位置
                posX += velocityX;
                posY += velocityY;
                
                // 获取当前容器尺寸
                const currentContainerRect = container.getBoundingClientRect();
                
                // 边界检测 - 使用容器边界
                if (posX <= 0) {
                    velocityX = Math.abs(velocityX);
                    posX = 0;
                } else if (posX >= currentContainerRect.width - imgWidth) {
                    velocityX = -Math.abs(velocityX);
                    posX = currentContainerRect.width - imgWidth;
                }
                
                if (posY <= 0) {
                    velocityY = Math.abs(velocityY);
                    posY = 0;
                } else if (posY >= currentContainerRect.height - imgHeight) {
                    velocityY = -Math.abs(velocityY);
                    posY = currentContainerRect.height - imgHeight;
                }
                
                // 应用新位置
                bg2.style.left = `${posX}px`;
                bg2.style.top = `${posY}px`;
                
                // 定位响应框在图像下方
                responseDiv.style.left = `${posX}px`;
                responseDiv.style.top = `${posY + imgHeight + 5}px`;
                
                // 继续动画
                requestAnimationFrame(moveImage);
            }
            
            // 开始动画
            moveImage();
        }
        
        // 如果图像已加载，直接初始化
        if (bg2.complete) {
            initAnimation();
        } else {
            // 否则等待加载完成
            bg2.addEventListener('load', initAnimation);
        }
        
        // 窗口大小变化时重新计算边界
        window.addEventListener('resize', function() {
            // 这里不需要额外处理，因为动画循环中会重新获取容器尺寸
        });
    </script>
</body>
</html>
